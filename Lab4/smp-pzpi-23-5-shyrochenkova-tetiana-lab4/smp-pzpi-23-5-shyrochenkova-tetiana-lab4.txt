МІНІСТЕРСТВО ОСВІТИ І НАУКИ УКРАЇНИ
ХАРКІВСЬКИЙ НАЦІОНАЛЬНИЙ УНІВЕРСИТЕТ РАДІОЕЛЕКТРОНІКИ


КАФЕДРА ПРОГРАМНОЇ ІНЖЕНЕРІЇ




Звіт
з лабораторної роботи № 4 
з дисципліни «Скриптові мови програмування»
   








Виконала:                                                                                     Перевірив:
ст. гр. ПЗПІ-23-5                        		                ст. викладач кафедри ПІ
Широченкова Тетяна Василівна    	          	               Сокорчук Ігор Петрович






Харків 2025
1 ІСТОРІЯ ЗМІН

№
Дата
Версія звіту
Опис змін та виправлень
1
12.05.2025
0.1
Створено розділ «Завдання»
2
13.05.2025
0.1
Створено розділ «Опис Виконаної роботи»
3
14.05.2025
0.1
Створено розділи «Висновки»,  «Додаток А», «Додаток Б», «Додаток В»



























2 ЗАВДАННЯ

     Метою другої лабораторної роботи є вдосконалення раніше створеного веб-магазину шляхом оптимізації структури сайту, реалізації аутентифікації користувачів і додавання можливості редагування профілю. 
     Завдання спрямоване на закріплення навичок роботи з сесіями, формами, завантаженням файлів, а також поділом коду на багаторазові компоненти для зручності супроводу та розширення функціоналу.

2.1  Вимоги до скрипта
     Скрипт має наступні вимоги: 
     —  виключити дублювання шапки та підвалу сайту шляхом виділення їх у окремі файли;
	—  забезпечити авторизацію користувачів з обмеженням доступу до сайту для неавторизованих;
     —  створити сторінку логіну з формою для введення імені користувача та пароля;
     —  реалізувати збереження стану авторизації через сесію;
     —  при неавторизованому доступі показувати сторінку з повідомленням про необхідність входу;
     —  додати сторінку профілю з можливістю перегляду та редагування особистої інформації;
     —  забезпечити завантаження та збереження фото користувача;
     —  Провести валідацію даних у формі профілю:
     а) всі поля мають бути заповнені;
     б) ім’я та прізвище — текстові рядки довжиною не менше одного символа;
	в)користувач має бути не молодше 16 років;
г)короткий опис користувача — не менше 50 символів.


3 ОПИС ВИКОНАНОЇ РОБОТИ

     Під час виконання роботи було створено окремі файли header.php та footer.php, які містять відповідно шапку та підвал сайту, що дозволило уникнути дублювання коду і спростити подальше редагування сайту. В головному файлі main.php реалізовано підключення цих частин, а також відображення потрібного контенту.
     Для реалізації системи авторизації створено сторінку логіну з формою, де користувач може ввести ім’я та пароль. Дані авторизації зберігаються у сесії, що дозволяє відслідковувати статус користувача під час роботи з сайтом. Неавторизованим користувачам замість контенту сайту відображається сторінка з повідомленням про необхідність увійти у систему.
     На сторінці профілю реалізовано можливість редагування особистих даних: імені, прізвища, дати народження, короткої інформації та фото користувача. Для завантаження фото використано форму з типом multipart/form-data. Перед збереженням даних проведено валідацію згідно з вимогами, щоб забезпечити коректність і повноту інформації.
     Таким чином, зроблено кроки до підвищення зручності користування сайтом, а також покращення організації коду та безпеки доступу.












4 ВИСНОВКИ

     В ході лабораторної роботи було удосконалено структуру веб-сайту шляхом винесення шапки та підвалу у окремі файли, що дозволило уникнути дублювання коду і зробило проект більш зручним для підтримки та розвитку. Було реалізовано базову систему авторизації, яка обмежує доступ до контенту сайту лише для зареєстрованих користувачів, підвищуючи безпеку і контроль над використанням ресурсу.
     Додано сторінку профілю користувача з можливістю завантаження особистого фото і редагування персональних даних. Впроваджена валідація введених даних гарантує якість і достовірність інформації. Реалізація цих функціональних можливостей значно покращила зручність користування сайтом і зробила його більш функціональним.
     Отриманий досвід сприяє поглибленому розумінню роботи з PHP, сесіями, формами та обробкою файлів, а також основ веб-безпеки і організації коду. Це є важливим кроком у вивченні розробки динамічних веб-додатків.
     
     






ДОДАТОК А
Відеозапис

Відеозапис презентації результатів лабораторної роботи: https://youtu.be/vf6D783tT7w

Хронологічний опис відеозапису:
00:00 Внесені зміни
00:25 Кнопка “Увійти в акаунт”
00:35 Неавторизований користувач 
01:28 Логін
02:25 Профіль користувача 
03:08 Авторизований користувач 
04:05 Реалізація 
04:21 index.php
05:00 Дані користувача
05:17 store/credentials.php
06:26 store/profile.php
07:05 Зображення користувачів
08:37 views/404.php
09:00 views/login.php
10:14 views/profile.php








ДОДАТОК Б
Графічні матеріали


Рисунок Б.1 — Профіль користувача


Рисунок Б.2 — Сторінка “404”


Рисунок Б.3 — Кнопка “Увійти в акаунт”



ДОДАТОК В
Програмний код
В.1 smp-pzpi-23-5-shyrochenkova-tetiana 
GitHub репозиторій:
https://github.com/NureShyrochenkovaTetiana/smp-pzpi-23-5-shyrochenkova-tetiana/tree/main/Lab4/smp-pzpi-23-5-shyrochenkova-tetiana-lab4/smp-pzpi-23-5-shyrochenkova-tetiana-lab4-code

./index.php
  1 <?php
  2 
  3 require_once 'db/config.php';
  4 
  5 initializeDatabase();
  6 
  7 session_start();
  8 
  9 $path = $_SERVER['PATH_INFO'] ?? '/';
 10 
 11 initializeDatabase();
 12 
 13 switch ($path) {
 14     case '/':
 15         include "./views/home.php";
 16         break;
 17     case '/goods':
 18         if (isset($_SESSION["username"])) {
 19             include "./views/goods.php";
 20         } else {
 21             include "./views/404.php";
 22         }
 23         break;
 24     case '/cart':
 25         if (isset($_SESSION["username"])) {
 26             include "./views/cart.php";
 27         } else {
 28             include "./views/404.php";
 29         }
 30         break;
 31     case '/login':
 32         if (!isset($_SESSION["username"])) {
 33             include 'views/login.php';
 34         } else {
 35             header("Location: " . "/");
 36         }
 37         break;
 38     case '/profile':
 39         if (isset($_SESSION["username"])) {
 40             include 'views/profile.php';
 41         } else {
 42             include "./views/404.php";
 43         }
 44         break;
 45     default:
 46         include "./views/404.php";
 47         break;
 48 }

./db/actions.php
  1 <?php
  2 
  3 function getGoods() {
  4     $connection = getDatabase();
  5 
  6     return $connection->query("SELECT * FROM goods")->fetchAll(PDO::FETCH_ASSOC);
  7 }
  8 
  9 function getCart() {
 10     $products = getGoods();
 11     $cartItems = [];
 12 
 13     foreach ($products as $product) {
 14         if (isset($_SESSION['cart'][$product['id']])) {
 15             $item = [
 16                 'id' => $product['id'],
 17                 'name' => $product['name'],
 18                 'price' => $product['price'],
 19                 'quantity' => $_SESSION['cart'][$product['id']],
 20                 'total' => $product['price'] * $_SESSION['cart'][$product['id']]
 21             ];
 22 
 23             $cartItems[] = $item;
 24         }
 25     }
 26 
 27     return $cartItems;
 28 }
 29 
 30 function getTotal($cart) {
 31     $total = 0;
 32 
 33     foreach ($cart as $item) {
 34         $total += $item['total'];
 35     }
 36 
 37     return $total;
 38 }

./db/config.php
  1 <?php
  2 
  3 function getDatabase() {
  4     return new PDO('sqlite:./db/storage.sqlite');
  5 }
  6 
  7 function initializeDatabase() {
  8     $connection = getDatabase();
  9 
 10     $connection->exec("
 11         CREATE TABLE IF NOT EXISTS goods (
 12             id INTEGER PRIMARY KEY AUTOINCREMENT,
 13             name TEXT NOT NULL,
 14             price REAL NOT NULL
 15         )
 16     ");
 17 
 18     $hasProducts = $connection->query("SELECT COUNT(*) FROM goods")->fetchColumn();
 19 
 20     if (!$hasProducts) {
 21         $connection->exec("
 22             INSERT INTO goods (name, price) VALUES
 23             ('Молоко пастеризоване', 12),
 24         ('Хліб чорний', 9),
 25         ('Сир білий', 21),
 26         ('Сметана 20%', 25),
 27         ('Кефір 1%', 19),
 28         ('Вода газована', 25),
 29         ('Печиво \"Весна\"', 25);
 30         ");
 31     }
 32 }

./store/credentials.php
  1 <?php
  2 
  3 $credentials = [
  4   "username" => "john_pork",
  5   "password" => "123456",
  6 ];

./store/profile.php
  1 <?php
  2 
  3 $profile = [
  4   "firstName" => "John",
  5   "lastName" => "Pork",
  6   "dateOfBirth" => "2000-12-12",
  7   "bio" => "Social media influencer and ex gangster.",
  8   "avatar" => "./uploads/bla.png",
  9 ];

./templates/footer.php
  1 <footer class="bg-slate-50 border-t border-slate-300">
  2     <div class="container mx-auto px-4 py-8">
  3         <div>
  4             <div class="flex flex-col md:flex-row justify-between items-center space-y-4 md:space-y-0">
  5                 <div class="flex items-center space-x-2">
  6                     <div class="flex h-8 w-8 items-center justify-center rounded-lg bg-green-600">
  7                         <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-white" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"><path d="M11 20A7 7 0 0 1 9.8 6.1C15.5 5 17 4.48 19 2c1 2 2 4.18 2 8c0 5.5-4.78 10-10 10"/><path d="M2 21c0-3 1.85-5.36 5.08-6C9.5 14.52 12 13 13 12"/></g></svg>
  8                     </div>
  9                     <span class="text-xl font-bold text-green-600">Весна</span>
 10                 </div>
 11                 <div class="inline-flex space-x-5">
 12                     <a href="/" class="block text-sm text-gray-600 hover:text-green-600 transition-colors">
 13                         Головна
 14                     </a>
 15                     <a href="/goods" class="block text-sm text-gray-600 hover:text-green-600 transition-colors">
 16                         Товари
 17                     </a>
 18                     <a href="/cart" class="block text-sm text-gray-600 hover:text-green-600 transition-colors">
 19                         Кошик
 20                     </a>
 21                 </div>
 22             </div>
 23         </div>
 24     </div>
 25 </footer>


./templates/header.php
  1 <header class="sticky top-0 z-50 w-full border-b bg-white/95 backdrop-blur border-b-slate-300 supports-[backdrop-filter]:bg-white/60">
  2     <div class="container mx-auto px-4">
  3         <div class="flex h-16 items-center justify-between">
  4             <div class="flex items-center space-x-2">
  5                 <div class="flex h-8 w-8 items-center justify-center rounded-lg bg-green-600">
  6                     <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-white" viewBox="0 0 24 24">
  7                         <g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"
  8                            stroke-width="2">
  9                             <path d="M11 20A7 7 0 0 1 9.8 6.1C15.5 5 17 4.48 19 2c1 2 2 4.18 2 8c0 5.5-4.78 10-10 10"
 10                             />
 11                             <path d="M2 21c0-3 1.85-5.36 5.08-6C9.5 14.52 12 13 13 12" />
 12                         </g>
 13                     </svg>
 14                 </div>
 15                 <span class="text-xl font-bold text-green-600">
 16                 Весна
 17               </span>
 18             </div>
 19             <nav class="hidden md:flex items-center space-x-8">
 20                 <a href="/" class="text-sm font-medium transition-colors hover:text-green-600">
 21                     Головна
 22                 </a>
 23                 <a href="/goods" class="text-sm font-medium transition-colors hover:text-green-600">
 24                     Товари
 25                 </a>
 26             </nav>
 27             <?php if(isset($_SESSION['username'])) : ?>
 28                 <div class="inline-flex gap-4">
 29                     <a href="/profile" class="flex items-center justify-center size-9 rounded-md text-base text-white bg-green-600 hover:bg-green-700 px-2 gap-2">
 30                         <svg xmlns="http://www.w3.org/2000/svg" class="size-5" viewBox="0 0 24 24"><!-- Icon from Lucide by Lucide Contributors - https://github.com/lucide-icons/lucide/blob/main/LICENSE --><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"><circle cx="12" cy="8" r="5"/><path d="M20 21a8 8 0 0 0-16 0"/></g></svg>
 31                     </a>
 32                     <a href="/cart" class="flex items-center justify-center min-w-32 h-9 rounded-md text-base text-white bg-green-600 hover:bg-green-700 px-2 gap-2">
 33                         <svg xmlns="http://www.w3.org/2000/svg" class="size-4" viewBox="0 0 24 24">
 34                             <path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m15 11l-1 9m5-9l-4-7M2 11h20M3.5 11l1.6 7.4a2 2 0 0 0 2 1.6h9.8a2 2 0 0 0 2-1.6l1.7-7.4M4.5 15.5h15M5 11l4-7m0 7l1 9" />
 35                         </svg>
 36                         Кошик
 37                     </a>
 38                 </div>
 39             <?php else : ?>
 40                 <a href="/login" class="flex items-center justify-center min-w-32 h-9 rounded-md text-base text-white bg-green-600 hover:bg-green-700 px-2 gap-2">
 41                     Увійти в акаунт
 42                 </a>
 43             <?php endif; ?>
 44         </div>
 45     </div>
 46 </header>

./views/404.php
  1 <!doctype html>
  2 <html lang="en">
  3 <head>
  4     <meta charset="UTF-8">
  5     <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
  6     <meta http-equiv="X-UA-Compatible" content="ie=edge">
  7     <title>Магазин "Весна"</title>
  8     <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
  9 </head>
 10 <body class="flex flex-col w-full h-dvh mt-auto">
 11 <?php include "./templates/header.php" ?>
 12 <main class="flex flex-col size-full bg-slate-50 items-center justify-center gap-6">
 13     <h1 class="scroll-m-20 text-2xl font-semibold tracking-tight">404</h1>
 14     <p class="text-xl font-medium tracking-tight">Сторінки, що ви шукаєте не існує</з>
 15 </main>
 16 <?php include "./templates/footer.php" ?>
 17 </body>
 18 </html>

./views/cart.php
  1 <?php
  2 
  3 require_once 'db/actions.php';
  4 
  5 $products = getGoods();
  6 $cartItemsForDisplay = getCart() ?? [];
  7 $total = getTotal($cartItemsForDisplay ?? []);
  8 
  9 if ($_SERVER["REQUEST_METHOD"] === "POST") {
 10     if (isset($_POST["action"])) {
 11         $productId = isset($_POST["product_id"]) ? (int)$_POST["product_id"] : null;
 12 
 13         if ($productId && isset($products[$productId])) {
 14             unset($_SESSION["cart"][$productId]);
 15         } else if ($_POST["action"] === "checkout") {
 16             unset($_SESSION["cart"]);
 17         }
 18     }
 19 
 20     header("Location: " . htmlspecialchars($_SERVER["PHP_SELF"]));
 21 }
 22 ?>
 23 <!doctype html>
 24 <html lang="en">
 25 
 26 <head>
 27     <meta charset="UTF-8">
 28     <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
 29     <meta http-equiv="X-UA-Compatible" content="ie=edge">
 30     <title>
 31         Магазин "Весна"
 32     </title>
 33     <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4">
 34     </script>
 35 </head>
 36 
 37 <body class="flex flex-col w-full h-dvh mt-auto">
 38 <?php include "./templates/header.php" ?>
 39 <main class="flex-1 container mx-auto px-4 py-8">
 40     <div class="mb-8">
 41         <h1 class="text-3xl font-bold mb-2">
 42             Наші товари
 43         </h1>
 44     </div>
 45     <div>
 46     <?php if (empty($cartItemsForDisplay)): ?>
 47         <div class="text-center py-12 bg-white shadow-md rounded-lg">
 48             <p class="text-gray-500 mb-4 text-xl">Ваш кошик пустий</p>
 49             <a href="/goods" class="inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 h-10 px-4 py-2 bg-green-600 text-white hover:bg-green-700">
 50                 Продовжити покупки
 51             </a>
 52         </div>
 53     <?php else: ?>
 54         <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
 55             <div class="lg:col-span-2">
 56                 <div class="bg-white shadow-md rounded-lg">
 57                     <div class="p-6">
 58                         <h2 class="text-xl font-semibold">Товари</h2>
 59                     </div>
 60                     <div class="p-6 pt-0">
 61                         <form method="POST" action="<?php echo htmlspecialchars($_SERVER["PHP_SELF"]); ?>">
 62                             <table class="w-full text-sm">
 63                                 <thead class="[&_tr]:border-b [&_tr]:border-b-slate-300 border-gray-200">
 64                                     <tr>
 65                                         <th class="h-12 px-3 text-left align-middle font-semibold text-gray-600">Назва</th>
 66                                         <th class="h-12 px-3 text-left align-middle font-semibold text-gray-600">Ціна</th>
 67                                         <th class="h-12 px-3 text-left align-middle font-semibold text-gray-600">Кількість</th>
 68                                         <th class="h-12 px-3 text-right align-middle font-semibold text-gray-600">До сплати</th>
 69                                         <th class="h-12 px-3 text-center align-middle font-semibold text-gray-600">Дії</th>
 70                                     </tr>
 71                                 </thead>
 72                                 <tbody class="[&_tr:last-child]:border-0">
 73                                     <?php foreach ($cartItemsForDisplay as $item): ?>
 74                                         <tr class="border-b-slate-300 border-gray-200 hover:bg-gray-50">
 75                                             <td class="p-3 align-middle font-medium text-gray-700"><?php echo htmlspecialchars($item['name']); ?></td>
 76                                             <td class="p-3 align-middle text-green-600">$<?php echo number_format($item['price'], 2); ?></td>
 77                                             <td class="p-3 align-middle">
 78                                                 <div class="flex items-center space-x-1">
 79                                                     <input
 80                                                         type="number"
 81                                                         min="0"
 82                                                         name="quantity_input"
 83                                                         value="<?php echo $item['quantity']; ?>"
 84                                                         class="w-16 text-center h-8 border-gray-300 rounded-md focus:ring-green-500 focus:border-green-500"
 85                                                         disabled
 86                                                     />
 87                                                 </div>
 88                                             </td>
 89                                             <td class="p-3 align-middle font-semibold text-right text-gray-700">$<?php echo number_format($item['total'], 2); ?></td>
 90                                             <td class="p-3 align-middle text-center">
 91                                                 <form method="POST" action="<?php echo htmlspecialchars($_SERVER["PHP_SELF"]); ?>" class="inline-flex">
 92                                                     <input type="hidden" name="product_id" value="<?php echo $item['id']; ?>">
 93                                                     <button
 94                                                         type="submit"
 95                                                         name="action" value="remove_item"
 96                                                         class="inline-flex items-center justify-center rounded-md text-sm font-medium border border-transparent h-8 w-8 text-red-600 hover:text-red-700 hover:bg-red-50"
 97                                                         title="Remove item"
 98                                                     >
 99                                                         <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="h-4 w-4"><path d="M3 6h18"/><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"/><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"/><line x1="10" y1="11" x2="10" y2="17"/><line x1="14" y1="11" x2="14" y2="17"/></svg>
100                                                     </button>
101                                                 </form>
102                                             </td>
103                                         </tr>
104                                     <?php endforeach; ?>
105                                 </tbody>
106                             </table>
107                         </form>
108                     </div>
109                 </div>
110             </div>
111 
112             <div class="lg:col-span-1">
113                 <div class="bg-white shadow-md rounded-lg">
114                     <div class="p-6">
115                          <h2 class="text-xl font-semibold">Підсумок замовлення</h2>
116                     </div>
117                     <div class="p-6 pt-0 space-y-4">
118                         <hr class="border-gray-200" />
119                         <div class="flex justify-between font-semibold text-lg text-gray-800">
120                             <span>До сплати:</span>
121                             <span class="text-green-600">$<?php echo number_format($total, 2); ?></span>
122                         </div>
123                         <form method="POST" action="<?php echo htmlspecialchars($_SERVER["PHP_SELF"]); ?>" class="space-y-3">
124                             <button type="submit" name="action" value="checkout" class="w-full inline-flex items-center justify-center rounded-md text-base font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 h-11 px-4 py-2 bg-green-600 text-white hover:bg-green-700">
125                                 Оформити замовлення
126                             </button>
127                             <a href="/" class="w-full inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 border border-gray-300 bg-white hover:bg-gray-100 hover:text-gray-800 h-10 px-4 py-2 text-gray-700">
128                                 Продовжити покупки
129                             </a>
130                         </form>
131                     </div>
132                 </div>
133             </div>
134         <?php endif; ?>
135     </div>
136 </main>
137 <?php include "./templates/footer.php" ?>
138 </body>
139 
140 </html>

./views/goods.php
  1 <?php
  2 
  3 require_once 'db/actions.php';
  4 
  5 $products = getGoods();
  6 
  7 if ($_SERVER["REQUEST_METHOD"] === "POST") {
  8     if (isset($_POST["add_to_cart_product_id"])) {
  9         $productId = (int)$_POST["add_to_cart_product_id"];
 10         $quantity = (int)$_POST["quantity"][$productId] ?? 0;
 11 
 12         if (isset($products[$productId])) {
 13             if ($quantity > 0) {
 14                 $_SESSION["cart"][$productId] = $quantity;
 15             }
 16         }
 17     }
 18 }
 19 
 20 ?>
 21 <!doctype html>
 22 <html lang="en">
 23 
 24 <head>
 25     <meta charset="UTF-8">
 26     <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
 27     <meta http-equiv="X-UA-Compatible" content="ie=edge">
 28     <title>
 29         Магазин "Весна"
 30     </title>
 31     <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4">
 32     </script>
 33 </head>
 34 
 35 <body class="flex flex-col w-full h-dvh mt-auto">
 36 <?php include "./templates/header.php" ?>
 37 <main class="flex-1 container mx-auto px-4 py-8">
 38     <div class="mb-8">
 39         <h1 class="text-3xl font-bold mb-2">
 40             Наші товари
 41         </h1>
 42     </div>
 43     <div>
 44         <?php if (!empty($products)): ?>
 45           <form method="POST">
 46               <table class="w-full text-sm">
 47                   <thead class="[&_tr]:border-b [&_tr]:border-b-slate-300">
 48                   <tr>
 49                       <th class="h-10 px-2 text-left align-middle font-semibold text-muted-foreground">
 50                           Назва
 51                       </th>
 52                       <th class="h-10 px-2 text-left align-middle font-semibold text-muted-foreground">
 53                           Ціна
 54                       </th>
 55                       <th class="h-10 px-2 text-left align-middle font-semibold text-muted-foreground w-32">
 56                           Кількість
 57                       </th>
 58                       <th class="h-10 px-2 text-left align-middle font-semibold text-muted-foreground text-right">
 59                           Дії
 60                       </th>
 61                   </tr>
 62                   </thead>
 63                   <tbody class="[&_tr:last-child]:border-0">
 64                     <?php foreach ($products as $product): ?>
 65                       <tr class="border-b border-b-slate-300 transition-colors hover:bg-gray-50 data-[state=selected]:bg-muted">
 66                           <td class="p-2 align-middle font-medium">
 67                             <?php echo htmlspecialchars($product['name']); ?>
 68                           </td>
 69                           <td class="p-2 align-middle font-semibold text-green-600">
 70                               $<?php echo number_format($product['price'], 2); ?>
 71                           </td>
 72                           <td class="p-2 align-middle">
 73                               <input type="number" min="0" placeholder="0" name="quantity[<?php echo $product['id']; ?>]" value="0" max="100" class="flex h-9 w-20 rounded-md border border-slate-300 border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50" />
 74                           </td>
 75                           <td class="p-2 align-middle text-right">
 76                               <button type="submit" name="add_to_cart_product_id" value="<?php echo $product['id']; ?>" class="inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 h-9 px-3 text-white bg-green-600 hover:bg-green-700">
 77                                   У кошик
 78                               </button>
 79                           </td>
 80                       </tr>
 81                     <?php endforeach; ?>
 82                   </tbody>
 83               </table>
 84           </form>
 85         <?php endif; ?>
 86     </div>
 87 </main>
 88 <?php include './templates/footer.php' ?>
 89 </body>
 90 </html>

./home.php
 $0); }' home.php
  1 <?php
  2 
  3 $products = []
  4 ?>
  5 <!doctype html>
  6 <html lang="en">
  7 <head>
  8     <meta charset="UTF-8">
  9     <meta name="viewport"
 10                 content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
 11     <meta http-equiv="X-UA-Compatible" content="ie=edge">
 12     <title>Магазин "Весна"</title>
 13     <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
 14 </head>
 15 <body class="flex flex-col w-full h-dvh mt-auto">
 16 <header class="sticky top-0 z-50 w-full border-b bg-white/95 border-b-slate-300 backdrop-blur supports-[backdrop-filter]:bg-white/60">
 17     <div class="container mx-auto px-4">
 18         <div class="flex h-16 items-center justify-between">
 19             <div class="flex items-center space-x-2">
 20                 <div class="flex h-8 w-8 items-center justify-center rounded-lg bg-green-600">
 21                     <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-white" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"><path d="M11 20A7 7 0 0 1 9.8 6.1C15.5 5 17 4.48 19 2c1 2 2 4.18 2 8c0 5.5-4.78 10-10 10"/><path d="M2 21c0-3 1.85-5.36 5.08-6C9.5 14.52 12 13 13 12"/></g></svg>
 22                 </div>
 23                 <span class="text-xl font-bold text-green-600">Весна</span>
 24             </div>
 25 
 26             <nav class="hidden md:flex items-center space-x-8">
 27                 <a href="/" class="text-sm font-medium transition-colors hover:text-green-600">
 28                     Головна
 29                 </a>
 30                 <a href="/goods" class="text-sm font-medium transition-colors hover:text-green-600">
 31                     Товари
 32                 </a>
 33             </nav>
 34 
 35             <a href="/cart" class="flex items-center justify-center min-w-32 h-9 rounded-md text-base text-white bg-green-600 hover:bg-green-700 gap-3 px-2">
 36                 <svg xmlns="http://www.w3.org/2000/svg" class="size-4" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m15 11l-1 9m5-9l-4-7M2 11h20M3.5 11l1.6 7.4a2 2 0 0 0 2 1.6h9.8a2 2 0 0 0 2-1.6l1.7-7.4M4.5 15.5h15M5 11l4-7m0 7l1 9"/></svg>
 37         Кошик
 38             </a>
 39         </div>
 40     </div>
 41 </header>
 42 <main class="flex flex-col size-full bg-slate-50 items-center justify-center gap-6">
 43     <h1 class="scroll-m-20 text-2xl font-semibold tracking-tight">Магазин "Весна"</h1>
 44 </main>
 45 <footer class="bg-slate-50 border-t border-slate-300">
 46     <div class="container mx-auto px-4 py-8">
 47         <div>
 48             <div class="flex flex-col md:flex-row justify-between items-center space-y-4 md:space-y-0">
 49                 <div class="flex items-center space-x-2">
 50                     <div class="flex h-8 w-8 items-center justify-center rounded-lg bg-green-600">
 51                         <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-white" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"><path d="M11 20A7 7 0 0 1 9.8 6.1C15.5 5 17 4.48 19 2c1 2 2 4.18 2 8c0 5.5-4.78 10-10 10"/><path d="M2 21c0-3 1.85-5.36 5.08-6C9.5 14.52 12 13 13 12"/></g></svg>
 52                     </div>
 53                     <span class="text-xl font-bold text-green-600">Весна</span>
 54                 </div>
 55                 <div class="inline-flex space-x-5">
 56                     <a href="/" class="block text-sm text-gray-600 hover:text-green-600 transition-colors">
 57                         Головна
 58                     </a>
 59                     <a href="/goods" class="block text-sm text-gray-600 hover:text-green-600 transition-colors">
 60                         Товари
 61                     </a>
 62                     <a href="/cart" class="block text-sm text-gray-600 hover:text-green-600 transition-colors">
 63                         Кошик
 64                     </a>
 65                 </div>
 66             </div>
 67         </div>
 68     </div>
 69 </footer>
 70 </body>
 71 </html>


./views/login.php
  1 <?php
  2 require_once "./store/credentials.php";
  3 
  4 $error_message = "";
  5 
  6 if ($_SERVER["REQUEST_METHOD"] === "POST") {
  7   global $credentials;
  8 
  9   if ($_POST["username"] != $credentials["username"] || $_POST["password"] != $credentials["password"]) {
 10     $error_message = "Невірний логін або пароль";
 11   } else {
 12     $_SESSION["username"] = $credentials["username"];
 13      $_SESSION["authorizedAt"] = time();
 14 
 15      header("Location: " . "/");
 16   }
 17 }
 18 
 19 ?>
 20 <!doctype html>
 21 <html lang="en">
 22 <head>
 23     <meta charset="UTF-8">
 24     <meta name="viewport"  content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
 25     <meta http-equiv="X-UA-Compatible" content="ie=edge">
 26     <title>Логін</title>
 27     <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
 28 </head>
 29 <body>
 30     <main class="flex w-full h-dvh justify-center items-center">
 31         <section class="flex flex-col w-fit h-auto gap-4 border border-slate-300 rounded-lg p-10">
 32             <h1 class="scroll-m-20 text-2xl font-semibold tracking-tight text-center">Логін</h1>
 33             <form class="flex flex-col w-[300px] gap-4" method="post">
 34                 <label for="username">
 35                     Ім?я користувача
 36                     <input
 37                         id="username"
 38                         name="username"
 39                         type="text"
 40                         placeholder="Введіть ім?я користувача"
 41                         class="bg-gray-50 border border-gray-300 text-black text-sm rounded-lg focus:ring-green-500 focus:border-green-500 focus:ring focus:ring-green-500 block w-full p-2.5 outline-none"
 42                         autofocus
 43                         required
 44                     />
 45                 </label>
 46                 <label for="password">
 47                     Пароль
 48                     <input
 49                         id="password"
 50                         name="password"
 51                         type="password"
 52                         placeholder="Введіть пароль"
 53                         class="bg-gray-50 border border-gray-300 text-black text-sm rounded-lg focus:ring-green-500 focus:border-green-500 focus:ring focus:ring-green-500 block w-full p-2.5 outline-none"
 54                         required
 55                     />
 56                 </label>
 57         
 58         <p class="text-red-500"><?php echo $error_message; ?></p>
 59 
 60                 <button class="w-full bg-green-600 text-white h-9 px-3 min-w-32 rounded-lg text-sm hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-700">Увійти</button>
 61                 <a href="/" class="text-sm text-center text-green-600 underline decoration-2">Перейти на головну</a>
 62             </form>
 63         </section>
 64     </main>
 65 </body>
 66 </html>

./views/profile.php
  1 <?php
  2 require_once 'store/profile.php';
  3 
  4 global $profile;
  5 
  6 if ($_SERVER["REQUEST_METHOD"] === "POST" && isset($_POST['firstName'])) {
  7     try {
  8     $birthDate = new DateTime($_POST['dateOfBirth']);
  9         $today = new DateTime();
 10 
 11         $age = $today->diff($birthDate)->y;
 12 
 13     if (strlen(trim($_POST["firstName"])) == 0) {
 14             throw new Exception("Ім?я обов?язкове");
 15         }
 16 
 17         if (strlen(trim($_POST['lastName'])) == 0) {
 18             throw new Exception("Прізвищем обов?язкове");
 19         }
 20 
 21         if (strlen(trim($_POST["bio"])) == 0) {
 22             throw new Exception("Опис обов?язковий");
 23         }
 24 
 25         if ($age < 16) {
 26             throw new Exception("Користувач не проходить за віковими обмеженнями");
 27         }
 28 
 29     $profile = [
 30       "firstName" => $_POST["firstName"],
 31       "lastName" => $_POST["lastName"],
 32       "bio" => $_POST["bio"],
 33       "dateOfBirth" => $_POST["dateOfBirth"],
 34       "avatar" => $profile["avatar"],
 35     ];
 36     } catch (Exception $e) {
 37         $error = $e->getMessage();
 38     }
 39 }
 40 
 41 if ($_SERVER["REQUEST_METHOD"] == "POST" && isset($_FILES['avatar'])) {
 42   $exts = ['jpg', 'jpeg', 'png'];
 43   $targetDir = './uploads/';
 44 
 45   $imageSize = getimagesize($_FILES["avatar"]["tmp_name"]);
 46 
 47     if (!$imageSize) {
 48         throw new Exception("Файл не є зображенням");
 49         }
 50 
 51     if ($_FILES["avatar"]["size"] > 2 * 1024 * 1024) {
 52         throw new Exception("Файл занадто великий");
 53     }
 54 
 55     $file = $targetDir . basename($_FILES["avatar"]["name"]);
 56 
 57     $imageFileType = strtolower(pathinfo($file, PATHINFO_EXTENSION));
 58 
 59     if (!in_array($imageFileType, $exts)) {
 60         throw new Exception("Дозволені лише розширення " . implode(', ', $exts));
 61     }
 62 
 63     move_uploaded_file($_FILES["avatar"]["tmp_name"], $file);
 64 
 65   $profile['avatar'] = $file;
 66 }
 67 
 68 if ($_SERVER["REQUEST_METHOD"] === "POST" && isset($_POST['logout_action'])) {
 69     unset($_SESSION["username"]);
 70     unset($_SESSION["authorizedAt"]);
 71 
 72     header("Location: /");
 73 }
 74 ?>
 75 <!doctype html>
 76 <html lang="en">
 77 <head>
 78     <meta charset="UTF-8">
 79     <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
 80     <meta http-equiv="X-UA-Compatible" content="ie=edge">
 81     <title>Магазин "Весна"</title>
 82     <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
 83 </head>
 84 <body class="flex flex-col w-full h-dvh mt-auto">
 85 <?php include "./templates/header.php" ?>
 86 <main class="flex flex-col size-full bg-slate-50 items-center justify-center gap-6">
 87 <div class="max-w-5xl mx-auto bg-white p-8 rounded-lg shadow-md">
 88         <div class="flex flex-col gap-4">
 89 
 90             <div class="flex flex-col items-center space-y-4">
 91         <img src="<?= $profile['avatar'] ?? '' ?>" alt="avatar" class="w-48 h-48 rounded-2xl">
 92         <form id="upload_form" method="post" enctype="multipart/form-data">
 93           <input id="upload" type="file" name="avatar" accept="image/*" required hidden />
 94           <label for="upload" class="flex bg-white justify-center items-center items-center leading-none text-black h-9 px-3 min-w-[128px] rounded-lg text-sm border border-slate-300 hover:bg-slate-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500">
 95             Завантажити
 96           </label>
 97         </form>
 98             </div>
 99 
100             <form class="md:col-span-2 space-y-6" method="post">
101                 <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
102                     <div>
103                         <label for="first_name" class="block text-sm font-semibold mb-1">Ім?я</label>
104                         <input
105                             id="first_name"
106                             name="firstName"
107                             type="text"
108                             placeholder="Введіть ім?я"
109                             class="bg-gray-50 outline-none border border-gray-300 text-black text-sm rounded-lg focus:ring-blue-500 focus:border-green-500 focus:ring focus:ring-green-500 block w-full p-2.5"
110                             value="<?= $profile['firstName'] ?? '' ?>"
111                             autofocus
112                             required
113                         />
114                     </div>
115                     <div>
116                         <label for="last_name" class="block text-sm font-semibold mb-1">Прізвище</label>
117                         <input
118                             id="last_name"
119                             name="lastName"
120                             type="text"
121                             placeholder="Введіть прізвище"
122                             class="bg-gray-50 outline-none border border-gray-300 text-black text-sm rounded-lg focus:ring-blue-500 focus:border-green-500 focus:ring focus:ring-green-500 block w-full p-2.5"
123                             value="<?= $profile['lastName'] ?? '' ?>"
124                             required
125                         />
126                     </div>
127                     <div>
128                         <label class="block text-sm font-semibold mb-1">Дата народження</label>
129                         <input
130                             id="date_of_birth"
131                             name="dateOfBirth"
132                             type="date"
133                             placeholder="Введіть ім?я"
134                             class="bg-gray-50 outline-none border border-gray-300 text-black text-sm rounded-lg focus:ring-blue-500 focus:border-green-500 focus:ring focus:ring-green-500 block w-full p-2.5"
135                             value="<?= $profile['dateOfBirth'] ?? '' ?>"
136                             required
137                         />
138                     </div>
139                 </div>
140 
141                 <div>
142                     <label for="description" class="block text-sm font-semibold mb-1">Опис</label>
143                     <input
144                         id="description"
145                         name="bio"
146                         class="bg-gray-50 outline-none border border-gray-300 text-black text-sm rounded-lg focus:ring-blue-500 focus:border-green-500 focus:ring focus:ring-green-500 block w-full p-2.5"
147                         placeholder="Напишіть щось про себе..."
148                         value="<?= $profile['bio'] ?? '' ?>"
149                     >
150                 </div>
151 
152                 <?php if (!empty($error)) : ?>
153                     <p class="text-red-500"><?= htmlspecialchars($error) ?></p>
154                 <?php endif ?>
155                 <div class="flex justify-end gap-3">
156                     <form method="post" action="<?php echo htmlspecialchars($_SERVER["PHP_SELF"]); ?>">
157                         <button name="logout_action" class="bg-red-600 text-white h-9 px-3 min-w-[128px] rounded-lg text-sm hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 ml-auto">
158                             Вийти
159                         </button>
160           </form>
161                     <button class="bg-green-600 text-white h-9 px-3 min-w-[128px] rounded-lg text-sm hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500">
162                         Зберегти
163                     </button>
164                 </div>
165             </form>
166         </div>
167     </div>
168 </main>
169 <?php include "./templates/footer.php" ?>
170 <script>
171   document.getElementById('upload').addEventListener('change', function () {
172     if (this.files.length > 0) {
173       document.getElementById('upload_form').submit();
174     }
175   });
176 </script>
177 </body>
178 </html>
7


